# FoodieHub üçΩÔ∏è - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –ø–æ–º–æ—â–Ω–∏–∫

<br/>

FoodieHub - —ç—Ç–æ –æ–Ω–ª–∞–π–Ω-—Å–µ—Ä–≤–∏—Å –∏ API –¥–ª—è –≥—É—Ä–º–∞–Ω–æ–≤ –∏ –ª—é–±–∏—Ç–µ–ª–µ–π –∫—É–ª–∏–Ω–∞—Ä–∏–∏. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏
–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ª—é–±–∏–º—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã, –∞ —Ç–∞–∫–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç—ã –¥—Ä—É–≥–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤,
—Å–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –±–ª—é–¥ –∏ —Å–∫–∞—á–∏–≤–∞—Ç—å —Å–≤–æ–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤.

–ü—Ä–æ–µ–∫—Ç –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º nginx, PostgreSQL –∏ Gunicorn. –ü—Ä–æ—Ü–µ—Å—Å
–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

![Image](preview.jpg)

### –°—Ç–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞

![Python](https://img.shields.io/badge/python-3.10.6-blue.svg?style=for-the-badge&logo=python&logoColor=ffdd54)
![Django](https://img.shields.io/badge/django-4.2.2-blue.svg?style=for-the-badge&logo=django&logoColor=11F7BB)
![Django REST framework](https://img.shields.io/badge/django_rest_framework-3.14.0-blue.svg?style=for-the-badge&logo=django&logoColor=ff7171)
![Nginx](https://img.shields.io/badge/nginx-1.19.3-blue.svg?style=for-the-badge&logo=nginx&logoColor=11FF44)
![Gunicorn](https://img.shields.io/badge/gunicorn-21.2.0-blue.svg?style=for-the-badge&logo=gunicorn&logoColor=11FF44)
![Docker](https://img.shields.io/badge/docker-24.0.5-blue.svg?style=for-the-badge&logo=docker&logoColor=33AAFF)
![PostgreSQL](https://img.shields.io/badge/postgreSQL-13.0-blue.svg?style=for-the-badge&logo=postgresql&logoColor=66EEFF)
![REST API Version](https://img.shields.io/badge/rest_api_version-1.0.0-blue?style=for-the-badge)
![CI/CD](https://img.shields.io/badge/CI_CD-github_acions-blue.svg?style=for-the-badge)
[![GitHub Actions](https://img.shields.io/badge/GitHub%20Actions-Workflow-blue?style=for-the-badge&logo=GitHub%20actions&logoColor=white)](https://github.com/features/actions)
[![gunicorn](https://img.shields.io/badge/gunicorn-20.1.0-blue?style=for-the-badge&logo=gunicorn&logoColor=white)](https://gunicorn.org/)
[![SimpleJWT](https://img.shields.io/badge/simplejwt-4.7.2-blue?style=for-the-badge&logo=django&logoColor=white&color=blue)](https://github.com/davesque/django-rest-framework-simplejwt)
[![PyJWT](https://img.shields.io/badge/PyJWT-2.1.0-blue?style=for-the-badge&logo=python&logoColor=white&color=blue)](https://github.com/jpadilla/pyjwt)
[![Djoser](https://img.shields.io/badge/djoser-2.1.0-blue?style=for-the-badge&logo=django&logoColor=white&color=blue)](https://github.com/sunscrapers/djoser)
[![Docker-compose](https://img.shields.io/badge/Docker%20compose-2.10.0-blue?style=for-the-badge&logo=Docker&logoColor=white)](https://www.docker.com/)
[![Docker Hub](https://img.shields.io/badge/Docker%20Hub-latest-blue?style=for-the-badge&logo=Docker&logoColor=white)](https://www.docker.com/products/docker-hub)
[![–õ–∏—Ü–µ–Ω–∑–∏—è](https://img.shields.io/github/license/kluevevga/FoodieHub?color=blue&style=for-the-badge&labelColor=333333&logo=github)](https://github.com/kluevevga/FoodieHub/blob/master/LICENSE)
[![–†–∞–∑–º–µ—Ä –∫–æ–¥–∞](https://img.shields.io/github/languages/code-size/kluevevga/FoodieHub?style=for-the-badge&labelColor=333333&logo=github)](https://github.com/kluevevga/FoodieHub)
![GitHub Actions](https://img.shields.io/github/actions/workflow/status/kluevevga/FoodieHub/main.yml?style=for-the-badge)

### –ö–∞—Ç–∞–ª–æ–≥–∏

1. üìÅ **frontend:** —Ñ–∞–π–ª—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
2. üìÅ **infra:** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –≤–∫–ª—é—á–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx –∏ —Ñ–∞–π–ª
   docker-compose.
3. üìÅ **backend:** —Ñ–∞–π–ª—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –±—ç–∫–µ–Ω–¥-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
4. üìÅ **postman:** –∫–æ–ª–ª–µ–∫—Ü–∏—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –¥–ª—è Postman, —á—Ç–æ –æ–±–ª–µ–≥—á–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ API —Ç–µ—Å—Ç–æ–≤.
5. üìÅ **docs:** –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Redoc.

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫ Backend API –Ω–∞ —Ö–æ—Å—Ç–µ

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥ API –ª–æ–∫–∞–ª—å–Ω–æ, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç:

```shell
git clone https://github.com/kluev-evga/foodgram-project-react.git
```

2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```dotenv
SECRET_KEY=django-insecure-_u(dlspjs)6n28(sfn_6efk!qdn-gt5k5=d#=5sr7=2-z=!)%r
DEBUG=True
ALLOWED_HOSTS=
CSRF_TRUSTED_ORIGINS=
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ–≥–æ:
    * PowerShell (Windows):

   ```shell
   python -m venv venv
   .\venv\Scripts\activate
   ```

    * Git Bash (Windows), Linux, Mac:
   ```shell
   python -m venv venv
   source venv/Scripts/activate
   ```
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å –ø—Ä–æ–µ–∫—Ç–æ–º –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```shell
cd .\backend\
pip install -r requirements.txt
```

5. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

```shell
python3 manage.py migrate
python3 manage.py runserver
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://127.0.0.1:8000/, –∞ —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–∑–æ–≤–∞—Ç—å—Å—è sqlite –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è
—Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–µ–∫—Ç–æ–º.

6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ, –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV –∏–ª–∏ JSON:

```shell
python3 manage.py csv
python3 manage.py json
```

### CI / CD

Workflow pipeline –≤—ã–ø–æ–ª–Ω–µ–Ω –ø—Ä–∏ –ø–æ–º–æ—â–∏ github action –∏ —Å–æ—Å—Ç–æ–∏—Ç –∑–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ workflow main.yml
–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è workflow –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —É–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –Ω–∞–±–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

```dotenv
# github -> settings -> Secrets and variables

DEBUG                 # False
SECRET_KEY            # —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á django
ALLOWED_HOSTS         # example.com, - DNS —Å–µ—Ä–≤–µ—Ä–∞ + ","
CSRF_TRUSTED_ORIGINS  # example.com, - DNS —Å–µ—Ä–≤–µ—Ä–∞ + ","

DOCKER_USERNAME       # –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ dockerhub
DOCKER_PASSWORD       # dockerhub password

HOST                  # ip –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
USER                  # –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
SSH_KEY               # –∑–∞–∫—Ä—ã—Ç—ã–π ssh –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä                        
PASSPHRASE            # –∫–æ–¥–æ–≤–∞—è —Ñ—Ä–∞–∑–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–∞—è –∫ –∫–ª—é—á—É

POSTGRES_DB           # recipes - –ª—é–±–æ–µ –∏–º—è –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
POSTGRES_USER         # postgres - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å postgres (–∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
POSTGRES_PASSWORD     # –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è postgres (–ø—Ä–∏–¥—É–º—ã–≤–∞–µ–º –ª—é–±–æ–π)
DB_HOST               # db - –∏—Å–ø–æ–ª—å–∑—É–µ–º db - –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ docker compose
DB_PORT               # 5432

TELEGRAM_TO           # id –±–æ—Ç–∞ –Ω–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –¥–µ–ø–ª–æ–µ
TELEGRAM_TOKEN        # —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
```

### –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É

```shell
ssh user_name@server_ip
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ–∫–µ—Ä

```shell
sudo apt update
sudo apt upgrade
sudo apt install docker.io
```

–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É infra –≤ –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥

```shell
# ~ /infra/
# –í –ø–∞–ø–∫–µ infra –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 2 —Ñ–∞–π–ª–∞:  
nginx.conf
docker-compose.production.yml
```

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã

```shell
sudo docker compose -f docker-compose.production.yml exec backend python manage.py migrate
sudo docker compose -f docker-compose.production.yml exec backend python manage.py createsuperuser
sudo docker compose -f docker-compose.production.yml exec backend python manage.py collectstatic
sudo docker compose -f docker-compose.production.yml exec backend python manage.py csv
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ üöß

1. Docker

```yaml
nginx:
  ports:
    - "80:80"
    - "443:443"
  volumes:
    - ./certbot/www:/var/www/certbot/
    - ./certbot/conf/:/etc/nginx/ssl/

certbot:
  image: certbot/certbot:latest
  volumes:
    - ./certbot/www/:/var/www/certbot/
    - ./certbot/conf/:/etc/letsencrypt/
```

2. –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ nginx.conf

`–Ω–µ –∑–∞–±—ã–≤–∞–µ–º —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–∏ dns`

```nginx configuration
server {

    listen 80;
    listen [::]:80;
    server_name foodgram-project.dynnamn.ru www.foodgram-project.dynnamn.ru;
    server_tokens off;

    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    location / {
        return 301 https://foodgram-project.dynnamn.ru$request_uri;
    }
}
```

3. –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–º–∞–Ω–¥—É, —á—Ç–æ–±—ã –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–∞–ø–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤:

`–Ω–µ –∑–∞–±—ã–≤–∞–µ–º —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–∏ dns`

```shell
sudo docker compose run --rm  certbot certonly --webroot --webroot-path /var/www/certbot/ -d example.com
```

4. –¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –Ω–∞—Å –µ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, –º–æ–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –±–ª–æ–∫ 443:

`–Ω–µ –∑–∞–±—ã–≤–∞–µ–º —É–∫–∞–∑–∞—Ç—å —Å–≤–æ–∏ dns`  
–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è nginx.conf –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä nginx

```nginx configuration
server {
    listen 80;
    listen [::]:80;
    server_name example.com www.example.com;
    server_tokens off;

    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    location / {
        return 301 https://foodgram-project.dynnamn.ru$request_uri;
    }
}

server {
    listen 443 default_server ssl http2;
    listen [::]:443 ssl http2;
    server_name example.org;
    ssl_certificate /etc/nginx/ssl/live/example.org/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/live/example.org/privkey.pem;

    location / {
    	# ... –∑–∞–ø–æ–ª–Ω—è–µ–º –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—É—Ç–∏
    }
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

```shell
sudo docker compose run --rm certbot renew
```

<br/>

## –õ–∏—Ü–µ–Ω–∑–∏—è üìú

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π `MIT`. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏
–≤ [LICENSE](https://github.com/kluevevga/FoodieHub/blob/master/LICENSE).